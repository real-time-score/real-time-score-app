# 설정 화면

## 1. 개요

앱 설정 메뉴로, 알림 설정, 마케팅 수신 동의, 계정 관리 등의 기능을 제공합니다.

**원본 PDF 참조**: 78-80페이지

---

## 2. 앱설정 메뉴 리스트 (페이지 78)

### 2.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]        앱설정                   │
├─────────────────────────────────────┤
│                                     │
│  알림 설정                          │
├─────────────────────────────────────┤
│  알림설정                      [>]  │
├─────────────────────────────────────┤
│  마케팅 수신 동의              [>]  │
├─────────────────────────────────────┤
│                                     │
│  계정 관리                          │
├─────────────────────────────────────┤
│  비밀번호 변경                 [>]  │
├─────────────────────────────────────┤
│  연동 계정 관리                [>]  │
├─────────────────────────────────────┤
│                                     │
│  기타                               │
├─────────────────────────────────────┤
│  캐시 삭제                     [>]  │
├─────────────────────────────────────┤
│  회원탈퇴                      [>]  │
├─────────────────────────────────────┤
│                                     │
└─────────────────────────────────────┘
```

### 2.2 메뉴 구성

| 섹션 | 메뉴 | 설명 |
|------|------|------|
| 알림 설정 | 알림설정 | 푸시 알림 on/off 설정 |
| | 마케팅 수신 동의 | 마케팅 정보 수신 동의 관리 |
| 계정 관리 | 비밀번호 변경 | 비밀번호 변경 (이메일 가입자) |
| | 연동 계정 관리 | SNS 연동 계정 관리 |
| 기타 | 캐시 삭제 | 앱 캐시 데이터 삭제 |
| | 회원탈퇴 | 회원 탈퇴 처리 |

---

## 3. 알림설정 화면 (페이지 79)

### 3.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]       알림설정                  │
├─────────────────────────────────────┤
│                                     │
│  전체 알림                          │
│  ┌─────────────────────────────┐    │
│  │ 전체 알림 수신        [ON]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  * 전체 알림을 끄면 모든 푸시       │
│    알림이 수신되지 않습니다         │
│                                     │
├─────────────────────────────────────┤
│                                     │
│  세부 알림 설정                     │
│                                     │
│  경기 알림                          │
│  ┌─────────────────────────────┐    │
│  │ 경기 시작 알림        [ON]  │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 경기 종료 알림        [ON]  │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 관심 경기 알림        [ON]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  픽 알림                            │
│  ┌─────────────────────────────┐    │
│  │ 새 픽 등록 알림       [ON]  │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 픽 결과 알림          [ON]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  커뮤니티 알림                      │
│  ┌─────────────────────────────┐    │
│  │ 댓글 알림             [ON]  │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 좋아요 알림           [OFF] │    │
│  └─────────────────────────────┘    │
│                                     │
│  기타 알림                          │
│  ┌─────────────────────────────┐    │
│  │ 포인트 알림           [ON]  │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 공지사항 알림         [ON]  │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 3.2 알림 설정 항목

| 카테고리 | 항목 | 기본값 | 설명 |
|----------|------|--------|------|
| 전체 | 전체 알림 수신 | ON | 마스터 스위치, OFF 시 모든 알림 차단 |
| 경기 | 경기 시작 알림 | ON | 관심 경기 시작 전 알림 |
| | 경기 종료 알림 | ON | 관심 경기 종료 시 결과 알림 |
| | 관심 경기 알림 | ON | 관심 등록한 경기 관련 알림 |
| 픽 | 새 픽 등록 알림 | ON | 팔로우한 전문가 픽 등록 시 |
| | 픽 결과 알림 | ON | 구매/등록한 픽의 결과 알림 |
| 커뮤니티 | 댓글 알림 | ON | 내 게시글에 댓글 작성 시 |
| | 좋아요 알림 | OFF | 좋아요 받을 때 (기본 OFF) |
| 기타 | 포인트 알림 | ON | 포인트 적립/사용 시 |
| | 공지사항 알림 | ON | 새 공지사항 등록 시 |

### 3.3 알림 설정 로직

```
1. 전체 알림 OFF → 모든 세부 항목 비활성화 (UI dimmed)
2. 전체 알림 ON → 세부 항목 개별 설정 가능
3. 설정 변경 시 서버에 즉시 반영
4. 앱 푸시 권한이 없으면 설정 페이지에서 시스템 설정으로 이동 안내
```

---

## 4. 마케팅 수신 동의 (페이지 80)

### 4.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]    마케팅 수신 동의             │
├─────────────────────────────────────┤
│                                     │
│  마케팅 정보 수신 동의              │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 푸시 알림             [ON]  │    │
│  └─────────────────────────────┘    │
│  이벤트, 프로모션 등의 마케팅       │
│  정보를 푸시 알림으로 받습니다      │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 이메일                [OFF] │    │
│  └─────────────────────────────┘    │
│  이벤트, 프로모션 등의 마케팅       │
│  정보를 이메일로 받습니다           │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ SMS                   [OFF] │    │
│  └─────────────────────────────┘    │
│  이벤트, 프로모션 등의 마케팅       │
│  정보를 SMS로 받습니다              │
│                                     │
│  ────────────────────────────────   │
│                                     │
│  마케팅 수신 동의 변경 이력         │
│                                     │
│  2025.01.15 10:30                   │
│  푸시 알림 수신 동의                │
│                                     │
│  2025.01.10 15:45                   │
│  이메일 수신 거부                   │
│                                     │
└─────────────────────────────────────┘
```

### 4.2 마케팅 수신 항목

| 채널 | 기본값 | 설명 |
|------|--------|------|
| 푸시 알림 | OFF | 앱 푸시로 마케팅 정보 수신 |
| 이메일 | OFF | 이메일로 마케팅 정보 수신 |
| SMS | OFF | 문자 메시지로 마케팅 정보 수신 |

### 4.3 동의 이력 관리

- 모든 동의/철회 내역 기록
- 날짜, 시간, 변경 내용 표시
- 법적 증빙 자료로 활용

---

## 5. 비밀번호 변경

### 5.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]     비밀번호 변경               │
├─────────────────────────────────────┤
│                                     │
│  현재 비밀번호                      │
│  ┌─────────────────────────────┐    │
│  │ ••••••••             [👁]   │    │
│  └─────────────────────────────┘    │
│                                     │
│  새 비밀번호                        │
│  ┌─────────────────────────────┐    │
│  │                      [👁]   │    │
│  └─────────────────────────────┘    │
│  * 8자 이상, 영문/숫자/특수문자 조합│
│                                     │
│  새 비밀번호 확인                   │
│  ┌─────────────────────────────┐    │
│  │                      [👁]   │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │        비밀번호 변경         │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 5.2 비밀번호 규칙

- **최소 길이**: 8자 이상
- **조합 규칙**: 영문, 숫자, 특수문자 중 2가지 이상 조합
- **금지 항목**: 연속된 숫자(123, 321), 동일 문자 반복(aaa)
- **이전 비밀번호**: 최근 3개와 동일 불가

---

## 6. 연동 계정 관리

### 6.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]    연동 계정 관리               │
├─────────────────────────────────────┤
│                                     │
│  연동된 계정                        │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🍎 Apple     연동됨  [해제] │    │
│  │ user@icloud.com              │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🟢 Naver    미연동  [연동]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🟡 Kakao    미연동  [연동]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🔵 Google   미연동  [연동]  │    │
│  └─────────────────────────────┘    │
│                                     │
│  * 최소 1개의 계정은 연동되어       │
│    있어야 합니다                    │
│                                     │
└─────────────────────────────────────┘
```

### 6.2 지원 SNS

| SNS | 아이콘 | 설명 |
|-----|--------|------|
| Apple | 🍎 | Apple ID 로그인 |
| Naver | 🟢 | 네이버 아이디 로그인 |
| Kakao | 🟡 | 카카오 로그인 |
| Google | 🔵 | Google 계정 로그인 |

### 6.3 연동/해제 규칙

- 최소 1개 계정은 항상 연동 상태 유지
- 마지막 연동 계정 해제 시 다른 계정 연동 요구
- 연동 시 해당 SNS 인증 플로우 진행

---

## 7. 캐시 삭제

### 7.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]       캐시 삭제                 │
├─────────────────────────────────────┤
│                                     │
│  현재 캐시 용량                     │
│                                     │
│  ┌─────────────────────────────┐    │
│  │      245.8 MB               │    │
│  └─────────────────────────────┘    │
│                                     │
│  이미지, 동영상, 임시 데이터 등     │
│  저장된 캐시를 삭제합니다.          │
│                                     │
│  * 삭제 후 일부 콘텐츠 로딩이       │
│    느려질 수 있습니다               │
│                                     │
│  ┌─────────────────────────────┐    │
│  │        캐시 삭제             │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 7.2 캐시 삭제 대상

- 이미지 캐시 (프로필, 경기 이미지 등)
- API 응답 캐시
- 임시 파일
- 미리보기 데이터

---

## 8. 회원탈퇴

### 8.1 화면 구성

```
┌─────────────────────────────────────┐
│ [←]       회원탈퇴                  │
├─────────────────────────────────────┤
│                                     │
│  ⚠️ 회원탈퇴 안내                   │
│                                     │
│  회원탈퇴 시 다음 정보가            │
│  영구적으로 삭제됩니다:             │
│                                     │
│  • 프로필 정보                      │
│  • 작성한 게시글 및 댓글            │
│  • 등록한 픽 및 구매 내역           │
│  • 활동온도 및 배지                 │
│  • 보유 크레딧 (환불 불가)          │
│                                     │
│  ────────────────────────────────   │
│                                     │
│  탈퇴 사유 (선택)                   │
│  ┌─────────────────────────────┐    │
│  │ ○ 사용 빈도 낮음            │    │
│  │ ○ 서비스 불만족             │    │
│  │ ○ 개인정보 보호             │    │
│  │ ○ 기타                      │    │
│  └─────────────────────────────┘    │
│                                     │
│  ☐ 위 내용을 확인하였으며,         │
│    회원탈퇴에 동의합니다            │
│                                     │
│  ┌─────────────────────────────┐    │
│  │        회원탈퇴              │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 8.2 탈퇴 처리 규칙

| 항목 | 처리 방식 |
|------|----------|
| 계정 정보 | 즉시 삭제 |
| 게시글/댓글 | 작성자 "탈퇴한 회원"으로 표시 |
| 픽 데이터 | 통계용 익명화 후 보관 |
| 크레딧 | 환불 불가, 즉시 소멸 |
| 재가입 제한 | 동일 이메일 30일간 재가입 불가 |

### 8.3 탈퇴 사유 옵션

1. 사용 빈도 낮음
2. 서비스 불만족
3. 개인정보 보호 우려
4. 다른 서비스 이용
5. 기타 (직접 입력)

---

## 9. 데이터 요구사항

### 9.1 알림 설정 데이터

```typescript
interface NotificationSettings {
  userId: string;
  masterSwitch: boolean;

  // 경기 알림
  matchStart: boolean;
  matchEnd: boolean;
  favoriteMatch: boolean;

  // 픽 알림
  newPick: boolean;
  pickResult: boolean;

  // 커뮤니티 알림
  comment: boolean;
  like: boolean;

  // 기타 알림
  point: boolean;
  notice: boolean;

  updatedAt: string;
}
```

### 9.2 마케팅 동의 데이터

```typescript
interface MarketingConsent {
  userId: string;
  push: boolean;
  email: boolean;
  sms: boolean;
  updatedAt: string;
}

interface MarketingConsentHistory {
  id: string;
  userId: string;
  channel: 'push' | 'email' | 'sms';
  action: 'agree' | 'disagree';
  createdAt: string;
}
```

### 9.3 연동 계정 데이터

```typescript
interface LinkedAccount {
  userId: string;
  provider: 'apple' | 'naver' | 'kakao' | 'google';
  providerId: string;
  email: string | null;
  linkedAt: string;
}
```

### 9.4 회원탈퇴 데이터

```typescript
interface WithdrawalRequest {
  userId: string;
  reason: string;
  reasonDetail?: string;
  requestedAt: string;
  processedAt?: string;
  status: 'pending' | 'completed';
}
```

---

## 10. API 요구사항

### 10.1 알림 설정 조회/수정

```
GET /api/v1/users/me/settings/notifications
PUT /api/v1/users/me/settings/notifications
```

**Request (PUT)**
```json
{
  "masterSwitch": true,
  "matchStart": true,
  "matchEnd": true,
  "favoriteMatch": true,
  "newPick": true,
  "pickResult": true,
  "comment": true,
  "like": false,
  "point": true,
  "notice": true
}
```

### 10.2 마케팅 동의 조회/수정

```
GET /api/v1/users/me/settings/marketing
PUT /api/v1/users/me/settings/marketing
GET /api/v1/users/me/settings/marketing/history
```

### 10.3 비밀번호 변경

```
PUT /api/v1/users/me/password
```

**Request**
```json
{
  "currentPassword": "current123!",
  "newPassword": "newPass456@"
}
```

### 10.4 연동 계정 관리

```
GET /api/v1/users/me/linked-accounts
POST /api/v1/users/me/linked-accounts/{provider}
DELETE /api/v1/users/me/linked-accounts/{provider}
```

### 10.5 캐시 삭제

```
DELETE /api/v1/users/me/cache
```

### 10.6 회원탈퇴

```
POST /api/v1/users/me/withdraw
```

**Request**
```json
{
  "reason": "사용 빈도 낮음",
  "reasonDetail": null
}
```

---

## 11. 관리자 기능

### 11.1 사용자 설정 관리

| 기능 | 설명 |
|------|------|
| 알림 설정 조회 | 특정 사용자의 알림 설정 조회 |
| 마케팅 동의 현황 | 채널별 동의 현황 통계 |
| 동의 이력 조회 | 사용자별 동의 변경 이력 조회 |

### 11.2 회원탈퇴 관리

| 기능 | 설명 |
|------|------|
| 탈퇴 현황 대시보드 | 일/주/월별 탈퇴 현황 |
| 탈퇴 사유 분석 | 탈퇴 사유별 통계 |
| 탈퇴 처리 모니터링 | 탈퇴 처리 상태 확인 |

### 11.3 필요 API (Admin)

```
GET    /api/admin/users/{userId}/settings/notifications
GET    /api/admin/users/{userId}/settings/marketing
GET    /api/admin/users/{userId}/settings/marketing/history
GET    /api/admin/statistics/marketing-consent
GET    /api/admin/withdrawals
GET    /api/admin/withdrawals/statistics
GET    /api/admin/withdrawals/reasons
```

---

## 12. 화면 전환

| 액션 | 이동 화면 |
|------|----------|
| 알림설정 탭 | 알림설정 상세 화면 |
| 마케팅 수신 동의 탭 | 마케팅 수신 동의 화면 |
| 비밀번호 변경 탭 | 비밀번호 변경 화면 |
| 연동 계정 관리 탭 | 연동 계정 관리 화면 |
| 캐시 삭제 탭 | 캐시 삭제 화면 |
| 회원탈퇴 탭 | 회원탈퇴 화면 |
| 회원탈퇴 완료 | 로그인 화면으로 이동 |
